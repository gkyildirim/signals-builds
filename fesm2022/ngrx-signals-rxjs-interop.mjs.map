{
  "version": 3,
  "sources": ["../../../../modules/signals/rxjs-interop/src/rx-method.ts"],
  "sourcesContent": ["import {\n  assertInInjectionContext,\n  DestroyRef,\n  effect,\n  inject,\n  Injector,\n  isSignal,\n  Signal,\n  untracked,\n} from '@angular/core';\nimport { isObservable, noop, Observable, Subject, Unsubscribable } from 'rxjs';\n\ntype RxMethodInput<Input> = Input | Observable<Input> | Signal<Input>;\n\ntype RxMethod<Input> = ((input: RxMethodInput<Input>) => Unsubscribable) &\n  Unsubscribable;\n\nexport function rxMethod<Input>(\n  generator: (source$: Observable<Input>) => Observable<unknown>,\n  config?: { injector?: Injector }\n): RxMethod<Input> {\n  if (!config?.injector) {\n    assertInInjectionContext(rxMethod);\n  }\n\n  const injector = config?.injector ?? inject(Injector);\n  const destroyRef = injector.get(DestroyRef);\n  const source$ = new Subject<Input>();\n\n  const sourceSub = generator(source$).subscribe();\n  destroyRef.onDestroy(() => sourceSub.unsubscribe());\n\n  const rxMethodFn = (input: RxMethodInput<Input>) => {\n    if (isSignal(input)) {\n      const watcher = effect(\n        () => {\n          const value = input();\n          untracked(() => source$.next(value));\n        },\n        { injector }\n      );\n      const instanceSub = { unsubscribe: () => watcher.destroy() };\n      sourceSub.add(instanceSub);\n\n      return instanceSub;\n    }\n\n    if (isObservable(input)) {\n      const instanceSub = input.subscribe((value) => source$.next(value));\n      sourceSub.add(instanceSub);\n\n      return instanceSub;\n    }\n\n    source$.next(input);\n    return { unsubscribe: noop };\n  };\n  rxMethodFn.unsubscribe = sourceSub.unsubscribe.bind(sourceSub);\n\n  return rxMethodFn;\n}\n"],
  "mappings": ";AAAA,SACE,0BACA,YACA,QACA,QACA,UACA,UAEA,iBACK;AACP,SAAS,cAAc,MAAkB,eAA+B;AAOlE,SAAU,SACd,WACA,QAAgC;AAEhC,MAAI,CAAC,QAAQ,UAAU;AACrB,6BAAyB,QAAQ;EACnC;AAEA,QAAM,WAAW,QAAQ,YAAY,OAAO,QAAQ;AACpD,QAAM,aAAa,SAAS,IAAI,UAAU;AAC1C,QAAM,UAAU,IAAI,QAAO;AAE3B,QAAM,YAAY,UAAU,OAAO,EAAE,UAAS;AAC9C,aAAW,UAAU,MAAM,UAAU,YAAW,CAAE;AAElD,QAAM,aAAa,CAAC,UAA+B;AACjD,QAAI,SAAS,KAAK,GAAG;AACnB,YAAM,UAAU,OACd,MAAK;AACH,cAAM,QAAQ,MAAK;AACnB,kBAAU,MAAM,QAAQ,KAAK,KAAK,CAAC;MACrC,GACA,EAAE,SAAQ,CAAE;AAEd,YAAM,cAAc,EAAE,aAAa,MAAM,QAAQ,QAAO,EAAE;AAC1D,gBAAU,IAAI,WAAW;AAEzB,aAAO;IACT;AAEA,QAAI,aAAa,KAAK,GAAG;AACvB,YAAM,cAAc,MAAM,UAAU,CAAC,UAAU,QAAQ,KAAK,KAAK,CAAC;AAClE,gBAAU,IAAI,WAAW;AAEzB,aAAO;IACT;AAEA,YAAQ,KAAK,KAAK;AAClB,WAAO,EAAE,aAAa,KAAI;EAC5B;AACA,aAAW,cAAc,UAAU,YAAY,KAAK,SAAS;AAE7D,SAAO;AACT;",
  "names": []
}
